1. https://databricks.com/blog/2015/07/15/introducing-window-functions-in-spark-sql.html
2. USE BROADCAST in spark
